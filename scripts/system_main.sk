# ===============================================================================================================================================================================================
# Main Game System
#
# ==============================================================================================================================================================================================


# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# 死亡時処理
# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
on death of player:
    if {status} is 1:
        execute console command "spawnpoint %player% -27663 309 36470"
        set {sidebar.%player%} to 2
        set {rank.%player%} to {rank.dummy}
        reduce {rank.dummy} by 1
        reduce {surviver} by 1
        add 1 to {kills.%attacker%}
        set player's gamemode to spectator
        if attacker is player:
            broadcast "&b%attacker% &r✈► &c%victim%"
        else:
            broadcast "&c%victim% &rdead (%{rank.%player%}%位)"



# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# ブロック掘削
# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
on break:
    if {destroyable} is "true":
        stop
    else:
        if event-block is log:
            stop
        if event-block is planks:
            stop
        else:
            cancel event



# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# ブロック設置後に削除
# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#on place:
    #if event-block is log:
        #wait 5 seconds
        #break event-block
    #if event-block is planks:
        #wait 5 seconds
        #break event-block



# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# クラフト禁止
# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
on craft of crafting table:
    cancel event
    close player'S inventory
    message "&b[運営] &r作業台の作成はできません" to player



# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# ショップ展開トリガー
# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
on rightclick on villager:
    cancel event
    open chest inventory with 1 row named "&0Shop" to player
    set slot 2 of player's current inventory to diamond sword named "&d売る"
    set slot 6 of player's current inventory to emerald named "&a買う"
on inventory click:
    if event-item is black stained glass pane named " ":
        cancel event
    if event-item is barrier block named "&r&c閉じる":
        cancel event
        play sound "block.stone_button.click_on" to player
        close player's inventory






# ===============================================================================================================================================================================================
# ===Legacy System===
# ===============================================================================================================================================================================================
# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# タイマー({switch.timer}が"on"でタイマー作動)
# ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#every 1 second:
    #if {switch.timer} is "on":
        #reduce {timer} by 1
    #if {timer} is 0:
        #make player execute command "function shimashima:01_game_end"
        #set {switch.timer} to "off"



